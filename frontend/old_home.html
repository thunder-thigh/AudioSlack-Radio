<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SATI Radio Stream 24/7</title>
  <style>
    body {
      font-family: monospace, 'Courier New', Courier;
      background-color: #fff8dc; /* Light yellow */
      margin: 0;
      padding: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      color: #333300;
    }

    .player-container {
      background-color: #fffff0;
      border: 2px solid #cccc99;
      width: 80%;
      max-width: 600px;
      padding: 20px;
      text-align: center;
      box-shadow: 2px 2px 8px rgba(0, 0, 0, 0.2);
    }

    h1 {
      color: #444400;
      margin: 0 0 20px 0;
      font-size: 24px;
      text-transform: uppercase;
      letter-spacing: 2px;
      padding-bottom: 10px;
      border-bottom: 1px solid #aaa966;
    }

    .audioslack-logo {
      margin-bottom: 20px;
      font-size: clamp(10px, 1vw, 14px);
      line-height: 1.4;
      color: #666600;
      white-space: pre;
    }

    .player-controls {
      margin: 20px 0;
      border: 1px solid #cccaa0;
      padding: 15px;
      background-color: #fefbd8;
    }

    #audioPlayer {
      display: none;
    }

    .control-buttons {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-bottom: 15px;
    }

    .audioslack-button {
      background-color: #f0e68c;
      color: #333300;
      border: 1px solid #cccaa0;
      padding: 8px 16px;
      font-size: 14px;
      cursor: pointer;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .audioslack-button:hover {
      background-color: #fffacd;
      border-color: #bbb888;
    }

    .audioslack-button:active {
      background-color: #eee8aa;
    }

    #playerStatus {
      margin-top: 15px;
      color: #666600;
      font-size: 14px;
      letter-spacing: 1px;
    }

    .now-playing {
      background-color: #fff5b8;
      border: 1px solid #cccaa0;
      padding: 10px;
      margin-top: 20px;
    }

    .now-playing h2 {
      margin-top: 0;
      font-size: 18px;
      color: #666600;
      text-transform: uppercase;
    }

    #currentTrack {
      font-weight: bold;
      color: #444400;
      font-size: 16px;
      padding: 5px 0;
    }

    .volume-control {
      margin-top: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    #volumeSlider {
      width: 80%;
      margin: 0 auto;
      accent-color: #999900;
      height: 4px;
    }

    .volume-label {
      color: #999900;
      margin-right: 10px;
      font-size: 14px;
    }

    .footer {
      margin-top: 20px;
      font-size: 12px;
      color: #999966;
      border-top: 1px solid #cccaa0;
      padding-top: 10px;
    }
  </style>
</head>
<body>
  <div class="player-container">
    <h1>AudioSlack Radio Stream</h1>

    <div class="audioslack-logo">
    ___             ___      _____ __           __  
   /   | __  ______/ (_)___ / ___// /___ ______/ /__
  / /| |/ / / / __  / / __ \\__ \/ / __ `/ ___/ //_/
 / ___ / /_/ / /_/ / / /_/ /__/ / / /_/ / /__/ ,<   
/_/  |_\__,_/\__,_/_/\____/____/_/\__,_/\___/_/|_|  
                                                    
    </div>

    <div class="player-controls">
      <audio id="audioPlayer" autoplay>
        <source src="http://172.16.16.174:8000/radio.mp3" type="audio/mpeg" />
        Your browser does not support the audio element.
      </audio>

      <div class="control-buttons">
        <button id="playButton" class="audioslack-button">PLAY</button>
        <button id="stopButton" class="audioslack-button">STOP</button>
      </div>

      <div class="volume-control">
        <span class="volume-label">VOLUME:</span>
        <input type="range" id="volumeSlider" min="0" max="1" step="0.05" value="0.7" />
      </div>

      <div id="playerStatus">STATUS: CONNECTING...</div>
    </div>

    <div class="now-playing">
      <h2>[ NOW PLAYING ]</h2>
      <div id="currentTrack">Loading track information...</div>
    </div>

    <div class="footer">
      The AudioSlack Project • Streaming Radio • Est. 2025
    </div>
  </div>

  <script>
    const audioPlayer = document.getElementById('audioPlayer');
    const currentTrack = document.getElementById('currentTrack');
    const volumeSlider = document.getElementById('volumeSlider');
    const playButton = document.getElementById('playButton');
    const stopButton = document.getElementById('stopButton');
    const playerStatus = document.getElementById('playerStatus');

    audioPlayer.volume = volumeSlider.value;
    let isPlaying = false;

    function updateStatus(status) {
      playerStatus.textContent = 'STATUS: ' + status;
    }

    volumeSlider.addEventListener('input', () => {
      audioPlayer.volume = volumeSlider.value;
    });

    playButton.addEventListener('click', () => {
      if (!isPlaying) {
        audioPlayer.play()
          .then(() => {
            isPlaying = true;
            updateStatus('PLAYING');
          })
          .catch(error => {
            console.error('Error playing audio:', error);
            updateStatus('ERROR: COULD NOT PLAY');
          });
      }
    });

    stopButton.addEventListener('click', () => {
      audioPlayer.pause();
      isPlaying = false;
      updateStatus('STOPPED');
    });

    audioPlayer.addEventListener('playing', () => {
      isPlaying = true;
      updateStatus('PLAYING');
    });

    audioPlayer.addEventListener('pause', () => {
      isPlaying = false;
      updateStatus('PAUSED');
    });

    audioPlayer.addEventListener('error', (e) => {
      console.error('Audio error:', e);
      updateStatus('ERROR: AUDIO STREAM UNAVAILABLE');
      isPlaying = false;
    });

    function updateMetadata() {
      fetch('http://172.16.16.174:8000/status-json.xsl')
        .then(response => response.json())
        .then(data => {
          const streamInfo = data.icestats.source;
          const streamData = Array.isArray(streamInfo)
            ? streamInfo.find(s => s.listenurl.includes('radio.mp3'))
            : streamInfo;

          if (streamData) {
            let title = streamData.title || 'Unknown';
            let artist = streamData.artist || '';

            currentTrack.textContent = artist ? `${artist} - ${title}` : title;
          } else {
            currentTrack.textContent = 'Unknown Track';
          }
        })
        .catch(error => {
          console.error('Error fetching metadata:', error);
          currentTrack.textContent = 'Unable to load track information';
        });
    }

    window.addEventListener('DOMContentLoaded', () => {
      audioPlayer.play()
        .then(() => {
          isPlaying = true;
          updateStatus('PLAYING');
        })
        .catch(error => {
          updateStatus('READY - CLICK PLAY TO START');
          console.log('Auto-play prevented:', error);
        });
    });

    updateMetadata();
    setInterval(updateMetadata, 15000);
  </script>
</body>
</html>
